# 🎓 ManageBac Assignment Checker 详细使用教程

## 📚 目录
1. [🚀 快速上手](#-快速上手)
2. [💻 安装方式详解](#-安装方式详解)
3. [🎨 启动方式说明](#-启动方式说明)
4. [⚙️ 配置详细说明](#-配置详细说明)
5. [🔧 故障排除指南](#-故障排除指南)
6. [📱 高级功能使用](#-高级功能使用)
7. [🍎 macOS特别说明](#-macos特别说明)

---

## 🚀 快速上手

### 第一次使用（推荐流程）

**⭐ 最佳体验路径：**

```bash
# 1. 下载项目
git clone https://github.com/Hacker0458/managebac-assignment-checker.git
cd managebac-assignment-checker

# 2. 一键安装+自动启动
python3 优化安装器.py
```

**就这么简单！** 🎉 优化安装器会：
- ✅ 自动检查你的系统环境
- ✅ 安装所有需要的软件包
- ✅ 创建配置文件
- ✅ **自动打开应用程序**

### 如果遇到问题

如果优化安装器不工作，尝试这些替代方案：

```bash
# 方案1：Ultimate Installer
python3 ultimate_installer.py

# 方案2：智能启动器（直接启动）
python3 intelligent_launcher.py

# 方案3：GUI启动器
python3 gui_launcher.py
```

---

## 💻 安装方式详解

### 🌟 优化安装器.py（强烈推荐）

**特点：**
- ✅ 默认自动启动应用
- ✅ 零配置体验
- ✅ 智能错误检测
- ✅ 创建桌面快捷方式

**使用方法：**
```bash
python3 优化安装器.py
```

**输出示例：**
```
🌟 ManageBac Assignment Checker - 优化安装器 🌟
✨ 默认自动启动应用 | Auto-launch by default

Platform: Darwin | Python: 3.13

🚀 Starting optimized installation | 开始优化安装

🔍 System Check | 系统检查 ... ✅
📦 Installing Dependencies | 安装依赖 ... ✅
🌐 Installing Browser | 安装浏览器 ... ✅
⚙️ Creating Config | 创建配置 ... ✅
🔗 Creating Shortcuts | 创建快捷方式 ... ✅

🎉 Installation Complete | 安装完成
🚀 Auto-launching Application | 自动启动应用
```

### 🚀 ultimate_installer.py（多模式）

**特点：**
- 🎯 支持多种安装模式
- 🔧 智能后备方案
- 📊 详细安装报告
- 🌍 多语言支持

**使用方法：**
```bash
# 自动模式（推荐）
python3 ultimate_installer.py

# 图形界面模式
python3 ultimate_installer.py --mode gui

# 快速模式
python3 ultimate_installer.py --mode quick

# 修复模式
python3 ultimate_installer.py --repair

# 禁用自动启动
python3 ultimate_installer.py --no-auto-launch
```

### 🔧 advanced_installer.py（高级）

**特点：**
- 📋 状态跟踪
- 🔄 自动恢复
- 📊 详细日志
- 🎯 精确控制

**使用方法：**
```bash
python3 advanced_installer.py
```

### 🎨 enhanced_setup_gui.py（图形界面）

**特点：**
- 🖱️ 鼠标操作
- 📋 可视化配置
- 🎨 现代化界面
- 👥 小白友好

**使用方法：**
```bash
python3 enhanced_setup_gui.py
```

---

## 🎨 启动方式说明

### 🧠 intelligent_launcher.py（智能推荐⭐）

**最智能的启动器！**

**特点：**
- 🔍 自动环境检测
- 🚀 最佳启动方式选择
- 🔄 失败自动重试
- 📊 进程管理
- 🩺 详细错误诊断

**使用方法：**
```bash
# 基本使用
python3 intelligent_launcher.py

# 强制终止现有实例并重启
python3 intelligent_launcher.py --kill-existing
```

**输出示例：**
```
🧠 ManageBac Assignment Checker - Intelligent Launcher

🔍 Environment Check | 环境检查
   ✅ Python 3.13
   ✅ Display available
   ✅ Tkinter available
   ✅ Configuration file
   ✅ Dependencies

📋 Available launchers | 可用启动器:
   • Smart Launcher - 智能启动器
   • GUI Launcher - GUI启动器
   • App Runner - 应用运行器

🎯 Selected: Smart Launcher
🚀 Starting Smart Launcher | 启动 智能启动器
⏳ Initializing...........
✅ Smart Launcher started successfully!
```

### 🤖 smart_launcher.py（自适应）

**特点：**
- 🎯 自动检测GUI支持
- ⚙️ 命令行参数支持
- 🔧 配置向导集成
- 📋 使用帮助

**使用方法：**
```bash
# 自动模式
python3 smart_launcher.py

# 强制命令行模式
python3 smart_launcher.py --cli

# 运行配置向导
python3 smart_launcher.py --setup

# 检查环境
python3 smart_launcher.py --check
```

### 🎨 gui_launcher.py（GUI专用）

**特点：**
- 🖥️ GUI界面专用
- 🔍 依赖检查
- 🛠️ 自动安装缺失包
- 🎯 专业GUI优先

**使用方法：**
```bash
python3 gui_launcher.py
```

### 💻 main_new.py（命令行）

**特点：**
- ⌨️ 纯命令行界面
- 🔧 丰富的参数选项
- 📊 详细输出控制
- 🤖 脚本友好

**使用方法：**
```bash
# 基本使用
python3 main_new.py

# 交互模式
python3 main_new.py --interactive

# 指定输出格式
python3 main_new.py --format html

# 启用通知
python3 main_new.py --notify

# 调试模式
python3 main_new.py --debug

# 无头模式（后台运行）
python3 main_new.py --headless
```

---

## ⚙️ 配置详细说明

### 📄 .env 配置文件

安装后会创建 `.env` 配置文件，需要填入你的ManageBac信息：

```bash
# === ManageBac 基础配置 ===
MANAGEBAC_URL=https://your-school.managebac.cn
MANAGEBAC_EMAIL=your.email@school.edu
MANAGEBAC_PASSWORD=your_password

# === 输出配置 ===
# 报告格式 (html, json, markdown, console)
REPORT_FORMAT=html,console
# 输出目录
OUTPUT_DIR=reports
# 模板目录
TEMPLATE_DIR=templates

# === 语言和界面 ===
# 界面语言 (zh, en)
LANGUAGE=zh
# 时区设置
TIMEZONE=Asia/Shanghai

# === 浏览器配置 ===
# 无头模式 (true, false)
HEADLESS=true
# 浏览器超时 (秒)
BROWSER_TIMEOUT=30
# 等待时间 (秒)
WAIT_TIME=5

# === 通知配置 ===
# 启用通知 (true, false)
NOTIFICATIONS_ENABLED=true
# 通知方式 (desktop, email, webhook)
NOTIFICATION_METHODS=desktop
# 通知语言 (zh, en)
NOTIFICATION_LANGUAGE=zh

# === AI功能 (可选) ===
# OpenAI API密钥
# OPENAI_API_KEY=your_openai_api_key_here
# AI模型
# AI_MODEL=gpt-3.5-turbo

# === 高级配置 ===
# 调试模式 (true, false)
DEBUG=false
# 日志级别 (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO
# 最大重试次数
MAX_RETRIES=3

# === 邮件通知 (可选) ===
# EMAIL_SMTP_SERVER=smtp.gmail.com
# EMAIL_SMTP_PORT=587
# EMAIL_USERNAME=your.email@gmail.com
# EMAIL_PASSWORD=your_app_password
# EMAIL_TO=your.email@gmail.com

# === Webhook通知 (可选) ===
# WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
```

### 🔧 配置向导

如果手动编辑配置文件太复杂，可以使用配置向导：

```bash
# 使用smart_launcher的配置向导
python3 smart_launcher.py --setup

# 或使用setup_wizard
python3 setup_wizard.py
```

配置向导会引导你逐步设置：
1. ManageBac学校URL
2. 登录邮箱和密码
3. 报告格式和输出目录
4. 通知选项
5. 其他高级设置

---

## 🔧 故障排除指南

### ❌ 常见问题及解决方案

#### 1. 🚫 应用不自动启动

**问题描述：** 运行安装器后，应用程序没有自动打开

**解决方案：**
```bash
# 方案1：重新运行优化安装器
python3 优化安装器.py

# 方案2：直接使用智能启动器
python3 intelligent_launcher.py

# 方案3：检查进程是否已运行
ps aux | grep python | grep managebac

# 方案4：手动启动GUI
python3 gui_launcher.py
```

#### 2. 📦 依赖安装失败

**问题描述：** pip install 报错或包安装失败

**解决方案：**
```bash
# 方案1：更新pip
python3 -m pip install --upgrade pip

# 方案2：使用清华源
pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt

# 方案3：手动安装核心依赖
pip3 install python-dotenv requests playwright

# 方案4：使用虚拟环境
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# 或 venv\Scripts\activate  # Windows
pip install -r requirements.txt
```

#### 3. 🌐 浏览器安装失败

**问题描述：** Playwright浏览器下载失败

**解决方案：**
```bash
# 方案1：重新安装浏览器
python3 -m playwright install chromium

# 方案2：使用系统代理
export HTTP_PROXY=http://your-proxy:port
export HTTPS_PROXY=http://your-proxy:port
python3 -m playwright install chromium

# 方案3：手动下载
# 访问 https://playwright.dev/python/docs/browsers 获取手动安装指南
```

#### 4. 🔐 权限问题 (macOS/Linux)

**问题描述：** Permission denied 错误

**解决方案：**
```bash
# 方案1：给脚本执行权限
chmod +x *.py *.sh

# 方案2：使用sudo运行安装器
sudo python3 优化安装器.py

# 方案3：修复目录权限
sudo chown -R $(whoami) .
chmod -R 755 .
```

#### 5. 🖥️ GUI无法启动

**问题描述：** tkinter或GUI相关错误

**解决方案：**
```bash
# 检查tkinter是否可用
python3 -c "import tkinter; print('tkinter OK')"

# macOS安装tkinter
# tkinter通常随Python安装，如果缺失：
brew install python-tk

# Ubuntu/Debian安装tkinter
sudo apt-get install python3-tk

# 使用命令行模式作为备选
python3 smart_launcher.py --cli
```

#### 6. 🌍 网络连接问题

**问题描述：** 无法连接到ManageBac

**解决方案：**
```bash
# 检查网络连接
ping managebac.cn

# 检查DNS解析
nslookup your-school.managebac.cn

# 使用代理
export HTTP_PROXY=http://proxy:port
export HTTPS_PROXY=http://proxy:port

# 或在.env中设置
echo "HTTP_PROXY=http://proxy:port" >> .env
echo "HTTPS_PROXY=http://proxy:port" >> .env
```

### 🩺 诊断工具

#### 系统诊断脚本

```bash
# 运行完整系统测试
python3 test_auto_launch.py
```

#### 手动检查清单

```bash
# 1. 检查Python版本
python3 --version

# 2. 检查核心模块
python3 -c "
modules = ['tkinter', 'playwright', 'dotenv', 'requests']
for m in modules:
    try:
        __import__(m.replace('-', '_'))
        print(f'✅ {m}')
    except ImportError:
        print(f'❌ {m} - 需要安装')
"

# 3. 检查配置文件
ls -la .env

# 4. 检查日志
ls -la logs/
tail -f logs/error.log

# 5. 检查进程
ps aux | grep managebac
```

---

## 📱 高级功能使用

### 🔄 定时任务设置

#### macOS/Linux - 使用cron

```bash
# 编辑cron任务
crontab -e

# 添加每日9点检查
0 9 * * * cd /path/to/managebac-assignment-checker && python3 main_new.py --headless

# 每小时检查一次
0 * * * * cd /path/to/managebac-assignment-checker && python3 main_new.py --headless --notify
```

#### Windows - 任务计划程序

```batch
# 创建每日任务
schtasks /create /tn "ManageBac Daily Check" /tr "python main_new.py --headless" /sc daily /st 09:00

# 创建每小时任务
schtasks /create /tn "ManageBac Hourly Check" /tr "python main_new.py --headless --notify" /sc hourly
```

### 🤖 AI功能配置

#### 获取OpenAI API密钥

1. 访问 [OpenAI API](https://openai.com/api/)
2. 注册账户并获取API密钥
3. 在 `.env` 文件中添加：

```bash
OPENAI_API_KEY=your_api_key_here
AI_MODEL=gpt-3.5-turbo
AI_ENABLED=true
```

#### AI功能包括：

- 📊 **作业优先级分析** - 智能评估作业重要性
- ⏰ **智能提醒建议** - 基于历史数据的个性化提醒
- 📚 **学习计划推荐** - AI生成的学习时间安排
- 📝 **作业内容总结** - 自动提取关键信息

### 📧 邮件通知设置

#### Gmail设置示例

```bash
# 在.env文件中添加
EMAIL_SMTP_SERVER=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_USERNAME=your.email@gmail.com
EMAIL_PASSWORD=your_app_password  # 注意：使用应用专用密码
EMAIL_TO=your.email@gmail.com
EMAIL_ENABLED=true
```

#### 获取Gmail应用专用密码

1. 登录Gmail账户
2. 转到 账户设置 → 安全性
3. 启用两步验证
4. 生成应用专用密码
5. 使用该密码而非常规密码

### 🔗 Webhook集成

#### Slack集成示例

```bash
# 在.env文件中添加
WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
WEBHOOK_ENABLED=true
```

#### 自定义Webhook格式

可以通过修改 `managebac_checker/notifications.py` 来自定义Webhook消息格式。

---

## 🍎 macOS特别说明

### 🏗️ 构建原生macOS应用

想要将Python应用转换为原生macOS应用？我们提供了完整的构建方案！

#### 使用自动构建脚本

```bash
# 运行macOS应用构建器
python3 build_macos_app.py

# 构建完成后测试
./run_macos_app.sh

# 创建DMG安装包
./create_dmg.sh
```

#### 手动构建步骤

详细的手动构建指南请参考：[macOS应用转换指南](macos_conversion_guide.md)

### 🔔 macOS通知系统

我们的应用已经适配了macOS原生通知系统：

```bash
# macOS会显示漂亮的原生通知
# 包括：
# ✅ 作业提醒通知
# ✅ 逾期作业警告
# ✅ 检查完成通知
# ✅ 错误提示通知
```

### 🚀 macOS快捷启动

安装后会自动创建macOS快捷方式：

```bash
# 桌面快捷方式
~/Desktop/ManageBac作业检查器.command

# Launchpad中也会出现图标（如果构建了原生应用）
```

### 🔐 macOS安全设置

如果遇到"无法打开，因为它来自身份不明的开发者"：

```bash
# 方法1：在系统偏好设置中允许
系统偏好设置 → 安全性与隐私 → 通用 → 仍要打开

# 方法2：命令行允许
sudo spctl --add "/path/to/ManageBac作业检查器.app"

# 方法3：临时禁用Gatekeeper（不推荐）
sudo spctl --master-disable
```

---

## 🎉 使用技巧和最佳实践

### 💡 效率提升技巧

1. **使用桌面快捷方式** - 双击即可启动
2. **设置定时任务** - 让检查自动化
3. **启用通知** - 及时了解作业状态
4. **使用AI功能** - 获得智能学习建议
5. **自定义报告格式** - 适合自己的查看方式

### 🔧 维护建议

1. **定期更新** - `git pull origin main`
2. **清理日志** - `rm -rf logs/*.log`
3. **备份配置** - 复制 `.env` 文件
4. **监控性能** - 检查CPU和内存使用

### 🚀 性能优化

```bash
# 启用无头模式（减少资源消耗）
echo "HEADLESS=true" >> .env

# 调整超时设置（适应网络状况）
echo "BROWSER_TIMEOUT=60" >> .env

# 使用快速模式（跳过非必要检查）
python3 main_new.py --fast
```

---

## 📞 获取帮助

### 🆘 在线支持

- 🐛 [报告Bug](https://github.com/Hacker0458/managebac-assignment-checker/issues)
- 💡 [功能建议](https://github.com/Hacker0458/managebac-assignment-checker/discussions)
- 📧 邮件支持：support@example.com

### 📚 更多资源

- [📋 技术文档](CLAUDE.md)
- [🍎 macOS转换指南](macos_conversion_guide.md)
- [🔧 开发者指南](CONTRIBUTING.md)

---

## 🎓 总结

ManageBac Assignment Checker 是一个功能强大且用户友好的作业管理工具。通过本教程，你应该能够：

✅ 成功安装和配置应用
✅ 选择最适合的启动方式
✅ 解决常见问题
✅ 使用高级功能
✅ 在macOS上获得最佳体验

**记住最简单的开始方式：**
```bash
python3 优化安装器.py
```

**祝你学习愉快，再也不忘作业！** 🎉📚✨